import{g as L,a as G,r as $,b as q}from"./domain-35be8cad.js";import{r as f,g as T,h as M,o as g,c as k,a as E,b as n,w as l,F as x,n as C,e as r,f as d,t as O,i as K}from"./index-5c2911ba.js";import"./http-e687649d.js";import"./userInfo-b8e9852a.js";const Q={__name:"domain",setup(P){const b=f(),y=f(!1),u=f(!1),v=f(!1),t=T({domain:"",desc:"",id:""}),i=T({total:0,current:1,pageSize:10}),s=()=>{y.value=!0,L({current:i.current,pageSize:i.pageSize}).then(a=>{y.value=!1,b.value=a.data.records,i.current=a.data.current,i.total=a.data.total})},D=a=>{$({id:a.id}).then(e=>{C.open({message:e.msg}),s()})},N=a=>{v.value=!1,t.desc=a.desc,t.id=a.id,t.domain=a.domain,t.certificateKey=a.certificateKey.trim(),t.certificateContent=a.certificateContent.trim(),u.value=!0},A=a=>{q({id:a.id}).then(e=>{C.open({message:"任务已经提交，请稍等几分钟刷新列表"}),s()})},V=[{title:"编号",dataIndex:"id",key:"id"},{title:"域名",dataIndex:"domain",key:"domain"},{title:"备注",dataIndex:"desc",key:"desc"},{title:"证书密钥",dataIndex:"certificateKey",key:"certificateKey",ellipsis:!0},{title:"证书内容",dataIndex:"certificateContent",key:"certificateContent",ellipsis:!0},{title:"状态",dataIndex:"status",key:"status"},{title:"提示",dataIndex:"tips",key:"tips"},{title:"操作",key:"action"}],w=a=>{i.current=a.current,i.pageSize=a.pageSize,i.total=a.total,s()},B=()=>{v.value=!0,t.domain="",t.desc="",t.certificateKey="",t.certificateContent="",t.id=void 0,u.value=!0},R=()=>{G({...t}).then(a=>{C.open({message:a.msg}),s(),u.value=!1})};return M(()=>{s()}),(a,e)=>{const m=r("a-button"),z=r("a-table"),_=r("a-input"),c=r("a-form-item"),I=r("a-textarea"),U=r("a-form"),F=r("a-modal");return g(),k(x,null,[E("div",null,[n(m,{type:"primary",style:{"margin-bottom":"10px"},onClick:B},{default:l(()=>e[5]||(e[5]=[d("添加域名")])),_:1}),n(m,{type:"primary",style:{"margin-bottom":"10px","margin-left":"5px"},onClick:s},{default:l(()=>e[6]||(e[6]=[d("刷新")])),_:1}),n(z,{loading:y.value,columns:V,rowKey:"id","data-source":b.value,locale:{emptyText:"暂无数据,添加一个试试看看"},pagination:i,onChange:w,scroll:{x:10}},{bodyCell:l(({column:o,record:p})=>[o.key==="createTime"?(g(),k(x,{key:0},[d(O(new Date(p.createTime).toLocaleString()),1)],64)):K("",!0),o.key==="action"?(g(),k(x,{key:1},[n(m,{type:"primary",style:{"margin-bottom":"5px","margin-left":"5px"},onClick:S=>A(p)},{default:l(()=>e[7]||(e[7]=[d("获取SSL证书")])),_:2},1032,["onClick"]),n(m,{type:"primary",style:{"margin-bottom":"5px","margin-left":"5px"},onClick:S=>N(p)},{default:l(()=>e[8]||(e[8]=[d("编辑")])),_:2},1032,["onClick"]),n(m,{type:"primary",style:{"margin-bottom":"5px","margin-left":"5px"},onClick:S=>D(p)},{default:l(()=>e[9]||(e[9]=[d("删除")])),_:2},1032,["onClick"])],64)):K("",!0)]),_:1},8,["loading","data-source","pagination"])]),E("div",null,[n(F,{okText:"确定",cancelText:"取消",visible:u.value,"onUpdate:visible":e[4]||(e[4]=o=>u.value=o),title:"信息",onOk:R},{default:l(()=>[n(U,{model:t,ref:"formTable",layout:"vertical"},{default:l(()=>[n(c,{label:"域名 "},{default:l(()=>[n(_,{disabled:!v.value,value:t.domain,"onUpdate:value":e[0]||(e[0]=o=>t.domain=o),placeholder:"域名"},null,8,["disabled","value"])]),_:1}),n(c,{label:"备注"},{default:l(()=>[n(_,{value:t.desc,"onUpdate:value":e[1]||(e[1]=o=>t.desc=o),placeholder:"备注"},null,8,["value"])]),_:1}),n(c,{label:"证书",name:"certificateKey",rules:[{required:!1,message:"必须填写证书.key文件"}]},{default:l(()=>[n(I,{rows:6,value:t.certificateKey,"onUpdate:value":e[2]||(e[2]=o=>t.certificateKey=o),placeholder:`-----BEGIN RSA PRIVATE KEY-----
***大概是这样的证书私钥***
-----END RSA PRIVATE KEY-----`},null,8,["value"])]),_:1}),n(c,{label:"证书内容",name:"certificateContent",rules:[{required:!1,message:"映射描述必填"}]},{default:l(()=>[n(I,{rows:6,value:t.certificateContent,"onUpdate:value":e[3]||(e[3]=o=>t.certificateContent=o),placeholder:`-----BEGIN CERTIFICATE-----
***大概是这样的证书内容***
-----BEGIN CERTIFICATE-----`},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["visible"])])],64)}}};export{Q as default};
