import{g as F,a as L,r as G,b as $}from"./domain-24134c37.js";import{r as f,h as T,i as q,a as r,o as g,c as _,b as E,d as a,w as l,F as k,n as x,f as d,t as M,j as K}from"./index-f9e88132.js";import"./http-72129eb7.js";import"./userInfo-b8e9852a.js";const J={__name:"domain",setup(O){const C=f(),y=f(!1),c=f(!1),v=f(!1),e=T({domain:"",desc:"",id:""}),i=T({total:0,current:1,pageSize:10}),s=()=>{y.value=!0,F({current:i.current,pageSize:i.pageSize}).then(t=>{y.value=!1,C.value=t.data.records,i.current=t.data.current,i.total=t.data.total})},D=t=>{G({id:t.id}).then(n=>{x.open({message:n.msg}),s()})},N=t=>{v.value=!1,e.desc=t.desc,e.id=t.id,e.domain=t.domain,e.certificateKey=t.certificateKey.trim(),e.certificateContent=t.certificateContent.trim(),c.value=!0},A=t=>{$({id:t.id}).then(n=>{x.open({message:"任务已经提交，请稍等几分钟刷新列表"}),s()})},V=[{title:"编号",dataIndex:"id",key:"id"},{title:"域名",dataIndex:"domain",key:"domain"},{title:"备注",dataIndex:"desc",key:"desc"},{title:"证书密钥",dataIndex:"certificateKey",key:"certificateKey",ellipsis:!0},{title:"证书内容",dataIndex:"certificateContent",key:"certificateContent",ellipsis:!0},{title:"状态",dataIndex:"status",key:"status"},{title:"提示",dataIndex:"tips",key:"tips"},{title:"操作",key:"action"}],w=t=>{i.current=t.current,i.pageSize=t.pageSize,i.total=t.total,s()},B=()=>{v.value=!0,e.domain="",e.desc="",e.certificateKey="",e.certificateContent="",e.id=void 0,c.value=!0},R=()=>{L({...e}).then(t=>{x.open({message:t.msg}),s(),c.value=!1})};return q(()=>{s()}),(t,n)=>{const u=r("a-button"),z=r("a-table"),b=r("a-input"),m=r("a-form-item"),I=r("a-textarea"),U=r("a-form"),h=r("a-modal");return g(),_(k,null,[E("div",null,[a(u,{type:"primary",style:{"margin-bottom":"10px"},onClick:B},{default:l(()=>[d("添加域名")]),_:1}),a(u,{type:"primary",style:{"margin-bottom":"10px","margin-left":"5px"},onClick:s},{default:l(()=>[d("刷新")]),_:1}),a(z,{loading:y.value,columns:V,rowKey:"id","data-source":C.value,locale:{emptyText:"暂无数据,添加一个试试看看"},pagination:i,onChange:w,scroll:{x:10}},{bodyCell:l(({column:o,record:p})=>[o.key==="createTime"?(g(),_(k,{key:0},[d(M(new Date(p.createTime).toLocaleString()),1)],64)):K("",!0),o.key==="action"?(g(),_(k,{key:1},[a(u,{type:"primary",style:{"margin-bottom":"5px","margin-left":"5px"},onClick:S=>A(p)},{default:l(()=>[d("获取SSL证书")]),_:2},1032,["onClick"]),a(u,{type:"primary",style:{"margin-bottom":"5px","margin-left":"5px"},onClick:S=>N(p)},{default:l(()=>[d("编辑")]),_:2},1032,["onClick"]),a(u,{type:"primary",style:{"margin-bottom":"5px","margin-left":"5px"},onClick:S=>D(p)},{default:l(()=>[d("删除")]),_:2},1032,["onClick"])],64)):K("",!0)]),_:1},8,["loading","data-source","pagination"])]),E("div",null,[a(h,{okText:"确定",cancelText:"取消",visible:c.value,"onUpdate:visible":n[4]||(n[4]=o=>c.value=o),title:"信息",onOk:R},{default:l(()=>[a(U,{model:e,ref:"formTable",layout:"vertical"},{default:l(()=>[a(m,{label:"域名 "},{default:l(()=>[a(b,{disabled:!v.value,value:e.domain,"onUpdate:value":n[0]||(n[0]=o=>e.domain=o),placeholder:"域名"},null,8,["disabled","value"])]),_:1}),a(m,{label:"备注"},{default:l(()=>[a(b,{value:e.desc,"onUpdate:value":n[1]||(n[1]=o=>e.desc=o),placeholder:"备注"},null,8,["value"])]),_:1}),a(m,{label:"证书",name:"certificateKey",rules:[{required:!1,message:"必须填写证书.key文件"}]},{default:l(()=>[a(I,{rows:6,value:e.certificateKey,"onUpdate:value":n[2]||(n[2]=o=>e.certificateKey=o),placeholder:`-----BEGIN RSA PRIVATE KEY-----
***大概是这样的证书私钥***
-----END RSA PRIVATE KEY-----`},null,8,["value"])]),_:1},8,["rules"]),a(m,{label:"证书内容",name:"certificateContent",rules:[{required:!1,message:"映射描述必填"}]},{default:l(()=>[a(I,{rows:6,value:e.certificateContent,"onUpdate:value":n[3]||(n[3]=o=>e.certificateContent=o),placeholder:`-----BEGIN CERTIFICATE-----
***大概是这样的证书内容***
-----BEGIN CERTIFICATE-----`},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["visible"])])],64)}}};export{J as default};
